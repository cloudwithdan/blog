{{ define "main" }}
{{ $pages := where .Site.RegularPages "Type" "in" (slice "posts" "post") }}
{{ if eq $pages nil }}
  {{ $pages = .Site.RegularPages }}
{{ end }}
<main class="posts">
  {{ range $pages.GroupByDate "2006" }}
  <section class="post-year">
    <h2 class="post-year-title">{{ .Key }}</h2>
    {{ range .Pages }}
    <article class="post-entry">
      <a href="{{ .RelPermalink }}">
        <span class="post-title">{{ .Title }}</span>
        <time class="post-date">{{ .Date.Format "Jan 2" }}</time>
      </a>
    </article>
    {{ end }}
  </section>
  {{ end }}
</main>
{{ end }}
